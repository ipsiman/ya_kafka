import re

BANNED_WORDS = {
    "дурак", "идиот", "глупый", "осел", "негодяй"
}

def censor_text(text: str) -> str:
    """
    Заменяет запрещённые слова на [CENSORED], сохраняя всю пунктуацию и пробелы.
    Работает с любыми разделителями: пробелы, запятые, восклицательные знаки и т.д.
    """
    def replace_word_with_censor(match):
        # Группа 1: начало (не-слово, например, пробелы, кавычки)
        # Группа 2: само слово (только буквы/цифры)
        # Группа 3: конец (пунктуация, пробелы и т.д.)
        start = match.group(1) or ""
        word = match.group(2)
        end = match.group(3) or ""

        clean_word = word.lower()
        if clean_word in BANNED_WORDS:
            return start + "[CENSORED]" + end
        return start + word + end

    # Регулярное выражение:
    # (?<=\s|^|[\s\W]) — позитивный просмотр назад: граница слова (пробел, начало строки, не-буква)
    # (\w+) — захватываем слово (только буквы/цифры)
    # (?=\s|$|[\s\W]) — позитивный просмотр вперёд: граница слова
    # Но чтобы захватить пунктуацию вокруг — используем более гибкий подход:

    # Ищем: (не-буквы в начале) + (слово) + (не-буквы в конце)
    pattern = r'([^\w]*)(\w+)([^\w]*)'

    # Применяем замену по всему тексту
    result = re.sub(pattern, replace_word_with_censor, text, flags=re.UNICODE)

    return result
